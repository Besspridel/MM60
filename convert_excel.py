import pandas as pd
import json

# –ó–∞–≥—Ä—É–∂–∞–µ–º Excel-—Ñ–∞–π–ª
df = pd.read_excel('materials.XLS')  # –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è

# –ü–æ–∫–∞–∂–µ–º –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
print("üìÑ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü—ã:")
print(df.head())

# –í—ã–±–∏—Ä–∞–µ–º –Ω—É–∂–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã ‚Äî –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ:
# - –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ‚Äî –∫–æ–¥—ã
# - –≤—Ç–æ—Ä–æ–π ‚Äî –Ω–∞–∑–≤–∞–Ω–∏—è
df = df.iloc[:, [0, 1]]
df.columns = ['code', 'name']

# –£–¥–∞–ª—è–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
df = df.dropna()

# –°–æ–∑–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å {–∫–æ–¥: –Ω–∞–∑–≤–∞–Ω–∏–µ}
materials = {str(row['code']).strip(): str(row['name']).strip() for _, row in df.iterrows()}

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ JSON
with open('materials.json', 'w', encoding='utf-8') as f:
    json.dump(materials, f, ensure_ascii=False, indent=2)

print('‚úÖ –£—Å–ø–µ—à–Ω–æ! materials.json —Å–æ–∑–¥–∞–Ω.')